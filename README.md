# ğŸŒ± Application de Gestion de l'Irrigation AutomatisÃ©e

Application web basÃ©e sur une architecture microservices pour la gestion intelligente de l'arrosage agricole. Le systÃ¨me utilise les prÃ©visions mÃ©tÃ©orologiques et les donnÃ©es mÃ©tÃ©o en temps rÃ©el (API Open-Meteo) pour optimiser automatiquement les programmes d'arrosage.

## ğŸ—ï¸ Architecture

```
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚                    INFRASTRUCTURE                           â”‚
                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
                           â”‚  â”‚   ms_eureka     â”‚         â”‚    MS_config    â”‚            â”‚
                           â”‚  â”‚  Service Disco  â”‚â—„â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Config Server  â”‚            â”‚
                           â”‚  â”‚    :8761        â”‚         â”‚    :9999        â”‚            â”‚
                           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                           â”‚           â”‚         registre          â”‚ config               â”‚
                           â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â”‚
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚                      GATEWAY                                â”‚
                           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                           â”‚  â”‚                   Gateway :9090                      â”‚   â”‚
                           â”‚  â”‚     /api/stations/** /api/previsions/** /api/weatherâ”‚   â”‚
                           â”‚  â”‚     /api/programmes/** /api/journal/**              â”‚   â”‚
                           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                         â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                           MICROSERVICES MÃ‰TIER                             â”‚
                â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        MS_Meteo :8084         â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
     â”‚ HTTP/RESTâ”‚         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚       Arrosage :8083       â”‚â”‚
     â”‚          â”‚         â”‚  â”‚ â€¢ StationMeteo          â”‚  â”‚     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚â”‚
     â”‚          â”‚         â”‚  â”‚ â€¢ PrevisionMeteo        â”‚  â”‚â—„â”€â”€â”€â”€â”¼â”€â”€â”‚ â€¢ ProgrammeArrosage  â”‚  â”‚â”‚
     â”‚          â”‚         â”‚  â”‚ â€¢ OpenMeteoClient       â”‚  â”‚Feignâ”‚  â”‚ â€¢ JournalArrosage    â”‚  â”‚â”‚
     â”‚          â”‚         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚  â”‚ â€¢ MeteoClient (Feign)â”‚  â”‚â”‚
     â”‚          â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚â”‚
     â”‚          â”‚                         â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
     â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                    â”‚                                     â”‚
     â”‚                                    â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
     â”‚                                    â”‚        â”‚    RabbitMQ     â”‚          â”‚
     â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   (CloudAMQP)   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                   publish   â”‚ ChangementEvent â”‚  consume
     â”‚                                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â””â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                    EXTERNAL API                             â”‚
               â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
               â”‚  â”‚              Open-Meteo API (temps rÃ©el)             â”‚   â”‚
               â”‚  â”‚         https://api.open-meteo.com/v1/forecast       â”‚   â”‚
               â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ Flux de communication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  1. Sync (Feign)   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Arrosage â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Meteo   â”‚  RÃ©cupÃ©rer prÃ©visions/mÃ©tÃ©o temps rÃ©el
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  2. Async (RabbitMQ)  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Meteo   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ Arrosage â”‚  Alertes conditions critiques
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    publish/consume    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  (pluie>10mm, temp>35Â°C)
```

## ğŸ”§ Microservices

| Service | Port | Description |
|---------|------|-------------|
| **ms_eureka** | 8761 | Service Discovery |
| **MS_config** | 9999 | Configuration centralisÃ©e (Git) |
| **Gateway** | 9090 | API Gateway |
| **MS_Meteo** | 8084 | Gestion des stations et prÃ©visions mÃ©tÃ©o |
| **Arrosage** | 8083 | Planification et exÃ©cution de l'arrosage |

## ğŸ“‹ FonctionnalitÃ©s principales

### Microservice MÃ©tÃ©o
- Gestion des stations mÃ©tÃ©o (CRUD)
- Gestion des prÃ©visions mÃ©tÃ©o
- IntÃ©gration API Open-Meteo (mÃ©tÃ©o temps rÃ©el)
- Publication d'Ã©vÃ©nements RabbitMQ lors de conditions critiques

### Microservice Arrosage
- Planification automatique selon les prÃ©visions
- Ajustement intelligent du volume d'eau :
  - Pluie > 10mm â†’ Annulation
  - TempÃ©rature > 35Â°C â†’ +50% volume
  - Vent > 30km/h â†’ -20% volume
- Journal d'exÃ©cution des arrosages

## ğŸ”„ Communication

| Type | Technologie | Usage |
|------|-------------|-------|
| **Synchrone** | OpenFeign | Arrosage â†’ MÃ©tÃ©o (rÃ©cupÃ©rer prÃ©visions) |
| **Asynchrone** | RabbitMQ | MÃ©tÃ©o â†’ Arrosage (alertes conditions critiques) |

## ğŸš€ DÃ©marrage

### Ordre de lancement
```bash
1. MS_config      # ./mvnw spring-boot:run
2. ms_eureka      # ./mvnw spring-boot:run
3. Gateway        # ./mvnw spring-boot:run
4. MS_Meteo       # ./mvnw spring-boot:run
5. Arrosage       # ./mvnw spring-boot:run
```

### PrÃ©requis
- Java 17
- MySQL (port 3307)
- Maven

## ğŸ“¡ Endpoints principaux

### MÃ©tÃ©o (via Gateway :9090)
```
GET  /api/stations/all
POST /api/stations/create
GET  /api/previsions/station/{id}
GET  /api/weather/current?latitude=X&longitude=Y
```

### Arrosage (via Gateway :9090)
```
GET  /api/programmes
POST /api/programmes/planifier-auto
POST /api/programmes/planifier-temps-reel
POST /api/programmes/{id}/executer
GET  /api/journal
```

## ğŸ› ï¸ Technologies

- **Backend** : Spring Boot, Spring Cloud
- **Base de donnÃ©es** : MySQL
- **Message Broker** : RabbitMQ (CloudAMQP)
- **API Externe** : Open-Meteo
- **Conteneurisation** : Docker
